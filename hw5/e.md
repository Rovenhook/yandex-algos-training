1. Подумайте, как можно выразить условие "Каждого из K видов деревьев требуется сохранить хотя бы по одному экземпляру"?
2. Как поддерживать выполнение этого условия при уменьшении размера отрезка?